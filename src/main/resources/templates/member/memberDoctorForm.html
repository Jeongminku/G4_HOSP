<!-- 의료진 회원가입 폼 -->


<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
	xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
	layout:decorate="~{layouts/layout}">
<head>
<meta charset="UTF-8">
<title>순양병원</title>
<script th:inline="javascript">  
		$(document).ready(function(){
			var errorMessage = [[${errorMessage}]];
			if(errorMessage != null){
				alert(errorMessage);
			}

		});
	
		function medListEvent() {
			var doctor = $('#doctor');
			if(doctor.is(":checked")) {
				$('.medList').removeClass('d-none');
				$('#profile').removeClass('d-none');
			} else {
				$('.medList').addClass('d-none');
				$('#profile').addClass('d-none');
			}
		}

		
		
		// 생일 유효성 검사
		var birth = $('#birth');
		
		// 생년월일	birth 유효성 검사
			function test(){
			var dateStr = $('#birth').val();	
			console.log(dateStr);
			
			var year = Number(dateStr.substr(0,4)); // 입력한 값의 0~4자리까지 (연)
			var month = Number(dateStr.substr(4,2)); // 입력한 값의 4번째 자리부터 2자리 숫자 (월)
			var day = Number(dateStr.substr(6,2)); // 입력한 값 6번째 자리부터 2자리 숫자 (일)
			var today = new Date(); // 날짜 변수 선언
			var yearNow = today.getFullYear(); // 올해 연도 가져옴
			
			if(dateStr.length<8 || dateStr.length>8){
				$('#birth_check').text('생년월일은 19990909형식의 8자로 작성해주세요.');
			}else if(dateStr.length = 8){
				$('#birth_check').text('생년월일 형식이 일치합니다.');
				$('#birth_check').css('color', 'green');
			}	// 연도의 경우 1900 보다 작거나 yearNow 보다 크다면 false를 반환합니다.
				else  if (1900 > year || year > yearNow){	
				}else if (month < 1 || month > 12) {
							
					$('#birth_check').text('생년월일을 확인해주세요.');
					$('#birth_check').css('color', 'red');
				}else if (day < 1 || day > 31) {
					
					$('#birth_check').text('생년월일을 확인해주세요.');
					$('#birth_check').css('color', 'red');
					
					}else if ((month==4 || month==6 || month==9 || month==11) && day==31) {
					
					$('#birth_check').text('생년월일을 확인해주세요.');
					$('#birth_check').css('color', 'red');
					
					}else if (month == 2) {
					
					var isleap = (year % 4 == 0 && (year % 100 != 0 || year % 400 == 0));
					
					if (day>29 || (day==29 && !isleap)) {
						
						$('#birth_check').text('생년월일을 확인해주세요.');
						$('#birth_check').css('color', 'red');
					
					}else{
						$('#birth_check').text('');
						birth = true;
					}//end of if (day>29 || (day==29 && !isleap))
					
				
				}else{
					
					$('#birth_check').text(''); 
					birth = true;
				}//end of if
				
				};
				
				//ID 중복체크
				
				var loginid = $('#loginid');
				
				function chk() {
					var loginid = $('#loginid').val();
					var url = "/members/new/" + loginid;
					
					if (loginid != '') {
						$.ajax({
							type: 'GET',
							url : url,
							dataType : 'json',
							cache : false,
							success : function(result) {
								if (result == 0) {
									$('#chk_result').text('사용가능한 아이디입니다.');
									$('#chk_result').css('color', 'green');
								} else {
									$('#chk_result').text('이미 사용중인 아이디입니다. 다른 아이디를 입력해주세요.');
									$('#chk_result').css('color', 'red');
								}
							},
							error : function(a,b,c) {
								console.log(a,b,c);
							}
						});
					} else {
						$('#chk_result').text('아이디는 필수입력값입니다.');
						$('#chk_result').css('color', 'red');
						$('#loginid').focus();
					}
				};

	</script>
<!-- THYMELEAF CSS -->
<th:block layout:fragment="css">
	<style>
.wrap {
	width: 100%;
	margin: 0 auto;
}

.headwrap {
	margin: 0 auto;
}

.viewhead {
	text-align: center;
	margin-bottom: 10px;
}

.viewlineboxup {
	border-top: 4px solid black;
}

.viewlinebox {
	background-color: #eff3f7;
	padding: 60px 100px;
}

.linemenu {
	height: 50px;
	text-align: center;
	margin-top: 15px;
}

.tablemenu {
	padding: 15px;
	margin: 0 auto;
	background: white;
	width: 60%;
}

.detailbody {
	border: none;
}

.detail {
	width: 90%;
	height: 250px;
	background-color: #eff3f7;
}

.table_con {
	margin-top: 10px;
	text-align: center;
}

.cont_img {
	width: 15%;
}

.patientlist {
	text-align: center;
}

.pnamein {
	width: 80%;
}


.table tr {
	text-align: left;
}

.but {
	background: #205B8A;
	color: white;
}

.privateagree {
	margin-top: 25px;
	margin-bottom: 25px;
}
</style>
</th:block>
</head>
<body>
	<section layout:fragment="content" class="login spad">
		<div class="container">
			<div class="cont">
				<div class="row head" style="margin: 0 auto; margin-bottom: 150px">
					<div class="col-md-10 headwrap">
						<!-- <form th:action="'/members/tos'" method="post" name = "resvform" th:object="${quickReservationDto}"> -->
						<form action="/members/new/doctor" method="post" name="resvform"
							th:object="${memberFormDto}" enctype="multipart/form-data">
							<div class="col-md-12 viewhead">
								<h1>회원가입</h1>
							</div>

							<div class="col-md-12 viewlinebox">
								<div class="privateagree">
									<div class="signup">

										<div class="form-radio mb-4">

											<input class="d-none" type="hidden" name="role"
												value="DOCTOR" id="doctor" onclick="medListEvent()" />
											<!-- 	<label class="h4 btn btn-outline-secondary" for="doctor">의사</label>	 -->
										</div>
										<div class="form-textbox row mb-3">
											<span class="medList h5">진료과 &nbsp; &nbsp; &nbsp;</span>
											<div class="input-group medList">
												<select class="form-select" name="job" th:field="*{medId}">
													<option selected="selected" value="none">==진료과를 선택해주세요==</option>
													<option th:each="meds : ${memberFormDto.med}" th:value="${meds.medId}" th:text="${meds.medName}"></option>
												</select>
											</div>
										</div>

										<div class="form-textbox row mb-3">
											<label class="h5" th:for="nickname">아이디</label> <input
												type="text" th:field="*{loginid}" class="form-control"
												placeholder="아이디 입력" style="padding-left: 100px;"
												onkeyup="chk()" />
											<p th:if="${#fields.hasErrors('loginid')}"
												th:errors="*{loginid}" class="py-2 c-alert-color">잘못된
												LoginId 입력</p>
											<div id=chk_result class="chk_result c-alert-color py-2"></div>
										</div>
										<div class="form-textbox row mb-3">
											<label class="h5" for="password">비밀번호</label> <input
												type="password" th:field="*{pwd}" class="form-control"
												placeholder="패스워드 입력" style="padding-left: 100px;" />
											<p th:if="${#fields.hasErrors('pwd')}" th:errors="*{pwd}"
												class="py-2 c-alert-color">잘못된 password 입력</p>
										</div>
										<div class="form-textbox row mb-3">
											<label class="h5" th:for="name">이름</label> <input type="text"
												th:field="*{name}" class="form-control" placeholder="홍길동"
												style="padding-left: 100px;" />
											<p th:if="${#fields.hasErrors('name')}" th:errors="*{name}"
												class="py-2 c-alert-color">잘못된 이름 입력</p>
										</div>
										<div class="form-textbox row mb-3">
											<label class="h5" th:for="tel">전화번호</label> 
											<input type="text" th:field="*{tel}" class="form-control" placeholder="01012349876" style="padding-left: 100px;" />
											<p th:if="${#fields.hasErrors('tel')}" th:errors="*{tel}"
												class="py-2 c-alert-color">잘못된 전화번호 입력</p>
										</div>
										<div class="form-textbox row mb-3">
											<label class="h5" th:for="birth">생년월일</label> <input
												type="number" th:field="*{birth}" class="form-control"
												placeholder="19990101" style="padding-left: 100px;"
												onkeyup="test()" />
											<p th:if="${#fields.hasErrors('birth')}" th:errors="*{birth}"
												class="py-2 c-alert-color">잘못된 생년월일 입력</p>
											<div class="check_font c-alert-color py-2" id=birth_check></div>
										</div>
										
										<div class="form-textbox row mb-3">
											<label class ="h5"for="profile">프로필사진</label>
											<div id="image_container">
	                                <img id="preview" style="width: 50%;"/>
	                            </div>
											<input type="file" onchange="readURL(this);" class="form-control profile bg-white" name ="profileImg" id="profileImg" style="padding-left: 100px;">
											</div>
										
										
										
										<div class="form-textbox row signWrap w-100 flex-nowrap"
											style="text-align: center;">
											<button type="submit"
												class="submitSign w-50 btn btn-primary">회원가입</button>
											<button type="button" onclick="location.href='/'"
												class="submitSign w-50 ms-2 btn btn-primary">가입취소</button>
										</div>
										<input type="hidden" th:name="${_csrf.parameterName}"
											th:value="${_csrf.token}">
									</div>
								</div>
							</div>
						</form>
					</div>
				</div>
			</div>
		</div>
		<!-- 회원가입야ㅑㄱ관 끝 -->


		<!-- </div> -->
		<script src="vendor/jquery/jquery.min.js"></script>
		<script src="js/main.js"></script>
	</section>
</body>
</html>