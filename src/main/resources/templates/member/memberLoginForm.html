<!DOCTYPE html>
<html
  xmlns:th="http://www.thymeleaf.org"
  xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
  layout:decorate="~{layouts/layout}"
>
	<head>
		<meta charset="UTF-8" />
		<title> Insert title here </title> 
		<!-- THYMELEAF JS  -->
		<th:block>
			<script th:inline="javascript">
				//쿠키를 이용한 아이디 기억
				$(document).ready(function(){
					var userInputId = getCookie("userInputId"); //쿠키의 기로 값을 가져온다.
					var setCookieYN = getCookie("setCookieYN");
					
					if (setCookieYN == "Y") {
						$("#id_save").prop("checked", true); //체크박스에 체크
						$("#email").val(userInputId);
					} else {
						$("#id_save").prop("checked", false); //체크 체크해제
						
					}
					
					$('#loginbtn').click(function() {
						//아이디를 쿠키에 저장
						if($("#id_save").is(":checked")) { //is_save가 체크되어있으면 true를 리턴
							var userInputId = $("#email").val(); //이메일 값을 가져온다
							setCookie("userInputId", userInputId, 60); //60일동안 쿠키저장
							setCookie("setCookieYN", "Y", 60); 
						} else {
							deleteCookie("userInputId");
							deleteCookie("setCookieYN");
						}
					});
				});
			</script>
		</th:block>
	</head>
	<body>
		<section layout:fragment="content" class="d-flex align-items-center justify-content-center max-w-50">
			<form class="row g-3 d-flex flex-column align-items-end w-100" action="/members/login" method="post">
				<div>
					<label class="h4" th:for="loginid">아이디</label> 
					<input type="text" name="loginid" id="loginid" class="form-control">
				</div>
				<div>
					<label class="h4" th:for="password">비밀번호</label> 
					<input type="password" name="password" id="password" class="form-control">
				</div>
				<div>
					<!-- 로그인 오류시 에러메시지 출력하기 !  -->
					<p th:if="${loginErrorMsg}" class="error" th:text="${loginErrorMsg}"></p> 
					<label><input class="me-2" type="checkbox" name="id_save" id="id_save" />아이디 기억</label>
				</div>
				<div class="Find text-end">
					<p class="mb-2"> 아이디가 기억나지 않으신가요? <a th:href="'/members/FindId'" class="c-alert-color">아이디 찾기</a></p>
					<p> 비밀번호가 기억나지 않으신가요? <a th:href="'/members/FindPwd'" class="c-alert-color">비밀번호 찾기</a></p>
				</div>
				<div class="w-100 d-flex">
					<button type="submit" class="btn btn-primary mb-3 me-2 w-50" id="loginbtn" onclick="location.href='/'">로그인</button>
					<button type="button" class="btn btn-primary mb-3 w-50" onclick="location.href='/members/new'">회원가입</button>
				</div>
				<input type="hidden" th:name="${_csrf.parameterName}" th:value="${_csrf.token}">
			</form>
		</section>
	</body>
</html>